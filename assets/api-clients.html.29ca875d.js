import{_ as d,r as c,o as u,c as h,f as p,b as s,d as e,e as n,w as a,a as i}from"./app.33ffcc50.js";const D={},y=s("h1",{id:"api-client-layer",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#api-client-layer","aria-hidden":"true"},"#"),e(" API Client Layer")],-1),m=s("code",null,"api-clients.g.ts",-1),f={href:"https://github.com/axios/axios",target:"_blank",rel:"noopener noreferrer"},v=s("code",null,"coalesce-vue",-1),C=s("code",null,"AxiosClient",-1),g={href:"https://axios-http.com/docs/interceptors",target:"_blank",rel:"noopener noreferrer"},b={href:"https://axios-http.com/docs/config_defaults",target:"_blank",rel:"noopener noreferrer"},_={href:"https://github.com/IntelliTect/Coalesce/blob/dev/src/coalesce-vue/src/api-client.ts",target:"_blank",rel:"noopener noreferrer"},w={class:"table-of-contents"},A=i('<h2 id="concepts" tabindex="-1"><a class="header-anchor" href="#concepts" aria-hidden="true">#</a> Concepts</h2><h3 id="api-client" tabindex="-1"><a class="header-anchor" href="#api-client" aria-hidden="true">#</a> API Client</h3><p>A class, generated for each controller-backed type in your data model as <code>&lt;ModelName&gt;ApiClient</code> and exported from <code>api-clients.g.ts</code> containing one method for each API endpoint.</p><p>Each method on the API client takes in the regular parameters of the method as you would expect, as well as an optional <code>AxiosRequestConfig</code> parameter at the end that can be used to provide additional configuration for the single request, if needed.</p>',4),E=s("code",null,"get",-1),k=s("code",null,"list",-1),q=s("code",null,"count",-1),F=s("code",null,"save",-1),I=s("code",null,"delete",-1),x=s("code",null,"parameters",-1),T=s("code",null,"Promise<AxiosResponse<TApiResult>>",-1),P=s("code",null,"TApiResult",-1),R=s("code",null,"ItemResult",-1),S=s("code",null,"ItemResult<T>",-1),L=s("code",null,"ListResult<T>",-1),j=s("code",null,"AxiosResponse",-1),B={href:"https://axios-http.com/docs/res_schema",target:"_blank",rel:"noopener noreferrer"},W=s("code",null,"TApiResult",-1),M=s("code",null,"data",-1),O=s("code",null,"headers",-1),N=s("code",null,"T",-1),U=s("h3",{id:"api-callers-api-states",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#api-callers-api-states","aria-hidden":"true"},"#"),e(" API Callers/API States")],-1),V=s("p",null,[e("A stateful function for invoking an API endpoint, created with the "),s("code",null,"$makeCaller"),e(" function on an API Client. API Callers provide a wide array of functionality that is useful for working with API endpoints that are utilized by a user interface.")],-1),H=s("code",null,"coalesce-vue",-1),$=i('<h2 id="api-callers" tabindex="-1"><a class="header-anchor" href="#api-callers" aria-hidden="true">#</a> API Callers</h2><p>API Callers (typed with the name <code>ApiState</code> in <code>coalesce-vue</code>, sometimes also referred to as &quot;loaders&quot; or &quot;invokers&quot;) are stateful functions for invoking an API endpoint, created with the <code>$makeCaller</code> function on an API Client. A summary of features:</p><h4 id="endpoint-invocation" tabindex="-1"><a class="header-anchor" href="#endpoint-invocation" aria-hidden="true">#</a> Endpoint Invocation</h4><p>Each API Caller is itself a function, so it can be invoked to trigger an API request to the server.</p><h4 id="state-management" tabindex="-1"><a class="header-anchor" href="#state-management" aria-hidden="true">#</a> State management</h4><p>API Callers contain properties about the last request made, including things like <code>wasSuccessful</code>, <code>isLoading</code>, <code>result</code>, and more.</p><h4 id="concurrency-management" tabindex="-1"><a class="header-anchor" href="#concurrency-management" aria-hidden="true">#</a> Concurrency Management</h4><p>Using <code>setConcurrency(mode)</code>, you can configure how each individual caller handles what happens when multiple requests are made simultaneously</p><h4 id="argument-binding" tabindex="-1"><a class="header-anchor" href="#argument-binding" aria-hidden="true">#</a> Argument Binding</h4>',9),z=s("code",null,"args",-1),K=s("code",null,".invokeWithArgs()",-1),G=s("h3",{id:"creating-and-invoking-an-api-caller",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#creating-and-invoking-an-api-caller","aria-hidden":"true"},"#"),e(" Creating and Invoking an API Caller")],-1),J=s("p",null,[e("API Callers can be created with the "),s("code",null,"$makeCaller"),e(" method of an API Client. The way in which it was created affects how it is invoked, as the parameters that the caller accepts are defined when it is created.")],-1),Q={class:"custom-container tip"},X=s("p",{class:"custom-container-title"},"TIP",-1),Y=i(`<p>Some examples:</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#6A9955;">// Preamble for all the examples below:</span></span>
<span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">PersonApiClient</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&#39;@/api-clients.g&#39;</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> </span><span style="color:#4FC1FF;">client</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">new</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">PersonApiClient</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>A caller that takes no additional parameters:</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> </span><span style="color:#4FC1FF;">caller</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">client</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">$makeCaller</span><span style="color:#D4D4D4;">(</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#CE9178;">&quot;item&quot;</span><span style="color:#D4D4D4;">, </span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">c</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">c</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">namesStartingWith</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;A&quot;</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C586C0;">await</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">caller</span><span style="color:#D4D4D4;">();</span></span>
<span class="line"><span style="color:#9CDCFE;">console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">caller</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">result</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>A caller that takes custom parameters:</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> </span><span style="color:#4FC1FF;">caller</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">client</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">$makeCaller</span><span style="color:#D4D4D4;">(</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">methods</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">methods</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">namesStartingWith</span><span style="color:#D4D4D4;">, </span></span>
<span class="line"><span style="color:#D4D4D4;">    (</span><span style="color:#9CDCFE;">c</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">str</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">c</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">namesStartingWith</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">str</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C586C0;">await</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">caller</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;Rob&quot;</span><span style="color:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#9CDCFE;">console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">caller</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">result</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,6),Z=i(`<div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> </span><span style="color:#4FC1FF;">caller</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">client</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">$makeCaller</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;item&quot;</span><span style="color:#D4D4D4;">, </span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#6A9955;">// The parameter-based version is always required, even if it won&#39;t be used.</span></span>
<span class="line"><span style="color:#D4D4D4;">    (</span><span style="color:#9CDCFE;">c</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">str</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">c</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">namesStartingWith</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">str</span><span style="color:#D4D4D4;">),</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#6A9955;">// A function which creates a blank instance of the args object.</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#6A9955;">// All props should be initialized (i.e. not undefined) to work with Vue&#39;s reactivity.</span></span>
<span class="line"><span style="color:#D4D4D4;">    () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> ({</span><span style="color:#9CDCFE;">str:</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">null</span><span style="color:#D4D4D4;"> </span><span style="color:#C586C0;">as</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;"> | </span><span style="color:#4EC9B0;">null</span><span style="color:#D4D4D4;">, }),</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#6A9955;">// The function that accepts the args object and uses it:</span></span>
<span class="line"><span style="color:#D4D4D4;">    (</span><span style="color:#9CDCFE;">c</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">args</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">c</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">namesStartingWith</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">args</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">str</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9CDCFE;">caller</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">args</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">str</span><span style="color:#D4D4D4;"> = </span><span style="color:#CE9178;">&quot;Su&quot;</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#C586C0;">await</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">caller</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">invokeWithArgs</span><span style="color:#D4D4D4;">();</span></span>
<span class="line"><span style="color:#9CDCFE;">console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">caller</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">result</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>A caller that performs multiple async operations:</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> </span><span style="color:#4FC1FF;">deleteFirstNameStartingWith</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">client</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">$makeCaller</span><span style="color:#D4D4D4;">(</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#CE9178;">&quot;item&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">async</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">c</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">str</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> </span><span style="color:#4FC1FF;">namesResult</span><span style="color:#D4D4D4;"> = </span><span style="color:#C586C0;">await</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">c</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">namesStartingWith</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">str</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> </span><span style="color:#C586C0;">await</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">c</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">deletePersonByName</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">namesResult</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">data</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">object</span><span style="color:#D4D4D4;">[</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">])</span></span>
<span class="line"><span style="color:#D4D4D4;">    }</span></span>
<span class="line"><span style="color:#D4D4D4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C586C0;">await</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">caller</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;Rob&quot;</span><span style="color:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#9CDCFE;">console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">caller</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">result</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The first parameter, <code>resultType</code>, can either be one of <code>&quot;item&quot;</code> or <code>&quot;list&quot;</code>, indicating whether the method returns a <code>ItemResult</code> or <code>ListResult</code> (examples #1 and #3 above). It can also be a function which accepts the set of method metadata for the API Client and which returns the specific method metadata (example #2 above), or it can be a direct reference to a specific method metadata object.</p><h3 id="properties" tabindex="-1"><a class="header-anchor" href="#properties" aria-hidden="true">#</a> Properties</h3><p>The following state properties can be found on API Caller instances. These properties are useful for binding to in a user interface to display errors, results, or indicators of progress.</p><h4 id="all-callers" tabindex="-1"><a class="header-anchor" href="#all-callers" aria-hidden="true">#</a> All Callers</h4>`,7),ee=s("p",null,"True if there is currently a request pending for the API Caller.",-1),se=s("p",null,"A boolean indicating if the last request made was successful, or null if either no request has been made yet, or if a request has been made but has not yet completed.",-1),ne=s("p",null,"An error message from the last request, if any. Will be set to null upon successful completion of a request.",-1),ae=s("p",null,[e("True if "),s("code",null,"result"),e(" is non-null. This prop is useful in performance-critical scenarios where checking "),s("code",null,"result"),e(" directly will cause an overabundance of re-renders in high-churn scenarios.")],-1),oe=s("p",null,[e("Holds an object for the arguments of the function, and will be used if the caller is invoked with its "),s("code",null,"invokeWithArgs()"),e(" method. Useful for binding the arguments of a caller to inputs in a user interface.")],-1),le=s("p",null,"Only exists if the caller was created with the option of being invoked with an args object as described in the sections above.",-1),te=s("p",null,[e("Returns the URL for the method's HTTP endpoint. Any parameters are sourced from the "),s("code",null,"args"),e(" object. Useful for binding file-returning HTTP GET methods directly to "),s("code",null,"image"),e(" or "),s("code",null,"video"),e(" HTML elements.")],-1),re=s("p",null,"Only exists if the caller was created with the option of being invoked with an args object as described in the sections above.",-1),ie=s("h4",{id:"itemresult-based-callers",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#itemresult-based-callers","aria-hidden":"true"},"#"),e(" ItemResult-based Callers")],-1),ce=s("p",null,"The principal data returned by the previous request. Will be set to null if the last response received returned no data (e.g. if the response was an error response)",-1),pe=s("h4",{id:"listresult-based-callers",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#listresult-based-callers","aria-hidden":"true"},"#"),e(" ListResult-based Callers")],-1),de=s("p",null,"The principal data returned by the previous request. Will be set to null if the last response received returned no data (e.g. if the response was an error response).",-1),ue=s("p",null,"Properties which contain the pagination information returned by the previous request.",-1),he=s("h3",{id:"concurrency-mode",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#concurrency-mode","aria-hidden":"true"},"#"),e(" Concurrency Mode")],-1),De=i('<p>API callers have a <code>setConcurrency</code> method that allows you to customize how they behave when additional invocations are performed when there is already a request pending. There are four options available, with <code>&quot;disallow&quot;</code> being the default:</p><h5 id="disallow" tabindex="-1"><a class="header-anchor" href="#disallow" aria-hidden="true">#</a> <code>&quot;disallow&quot;</code></h5><p>The default behavior - simply throws an error for any secondary invocations.</p><div class="custom-container tip"><p class="custom-container-title">Note</p><p>Having <code>&quot;disallow&quot;</code> as the default prevents the unexpected behavior that can happen in a number of ways with the other modes:</p><ul><li>For requests that are performing data-mutating actions on the server, all other concurrency modes could lead to an unexpected end state of the data due to requests either being abandoned, cancelled, or potentially happening out-of-order.</li><li>Throwing errors for multiple concurrent requests quickly surfaces issues during development where concurrent requests are not being correctly guarded against in a user interface - e.g. not disabling a &quot;Save&quot; or &quot;Submit&quot; button while the request is pending, which would otherwise lead to double-posts.</li></ul></div><h5 id="debounce" tabindex="-1"><a class="header-anchor" href="#debounce" aria-hidden="true">#</a> <code>&quot;debounce&quot;</code></h5><p>When a secondary invocation is performed, enqueue it after the current pending invocation completes.</p><p>If additional invocations are performed while there is already an invocation enqueued and waiting, the already-enqueued invocation is abandoned and replaced by the most recent invocation attempt. The promise of the abandoned invocation will be resolved with <code>undefined</code> (it is NOT rejected).</p><h5 id="cancel" tabindex="-1"><a class="header-anchor" href="#cancel" aria-hidden="true">#</a> <code>&quot;cancel&quot;</code></h5><p>When a secondary invocation is performed, cancel the current pending invocation.</p>',9),ye={href:"https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.http.httpcontext.requestaborted?view=aspnetcore-3.1",target:"_blank",rel:"noopener noreferrer"},me=s("code",null,"undefined",-1),fe=i('<h5 id="allow" tabindex="-1"><a class="header-anchor" href="#allow" aria-hidden="true">#</a> <code>&quot;allow&quot;</code></h5><p>When a secondary invocation is performed, always continue normally, sending the request to the server.</p><p>The state of the properties on the caller at any time will reflect the most recent response received from the server, which is never guaranteed to correlate with the most recent request made to the server - that is, requests are not guaranteed to complete in the order they were made. In particular, the <code>isLoading</code> property will be <code>false</code> after the first response comes back, even if the second response has not yet been received.</p><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p>For the reasons outlined above, it is generally not recommended to use <code>&quot;allow&quot;</code> unless you fully understand the drawbacks. This mode mirrors the legacy behavior of the Knockout stack for Coalesce.</p></div><h3 id="response-caching" tabindex="-1"><a class="header-anchor" href="#response-caching" aria-hidden="true">#</a> Response Caching</h3><p>Response caching on API Callers is a feature that will save API responses to persistent storage (<code>sessionStorage</code> or <code>localStorage</code>). The next time a matching request is made, the <code>result</code> property of the API Caller will be populated with that saved response, allowing for a faster time to interactivity and reduced repaints and shifting of elements as initial data loads after a page navigation. It does not <em>prevent</em> any HTTP requests from being made, and does not affect the <code>Promise</code> returned from <code>invoke</code> or <code>invokeWithArgs</code>.</p><p>Common use cases include:</p><ul><li>Site-wide status or alert messages</li><li>Server-provided configuration</li><li>Dashboard data, like statistics or graphs</li></ul><p>When a cached response is loaded, <code>result</code> is populated with that response&#39;s data, <code>wasSuccessful</code> and <code>hasResult</code> are set to <code>true</code>, and <code>onFulfilled</code> callbacks are invoked.</p>',9),ve=s("code",null,"false",-1),Ce=i(`<div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#C586C0;">export</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">type</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">ResponseCachingConfiguration</span><span style="color:#D4D4D4;"> = {</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#6A9955;">/** Function that will determine the cache key used for a particular request.</span></span>
<span class="line"><span style="color:#6A9955;">   * Return a falsy value to prevent caching. The default key is the request URL.</span></span>
<span class="line"><span style="color:#6A9955;">   */</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#DCDCAA;">key</span><span style="color:#D4D4D4;">?: (</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">req</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">AxiosRequestConfig</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">defaultKey</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span></span>
<span class="line"><span style="color:#D4D4D4;">  ) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;"> | </span><span style="color:#4EC9B0;">null</span><span style="color:#D4D4D4;"> | </span><span style="color:#4EC9B0;">undefined</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#6A9955;">/** The maximum age of a cached response. If null, the entry will not expire. Default 1 hour.</span></span>
<span class="line"><span style="color:#6A9955;">   *</span></span>
<span class="line"><span style="color:#6A9955;">   * The smallest of the current configured max age and the max age that was set at the time of the cached response is used. */</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#9CDCFE;">maxAgeSeconds</span><span style="color:#D4D4D4;">?: </span><span style="color:#4EC9B0;">number</span><span style="color:#D4D4D4;"> | </span><span style="color:#4EC9B0;">null</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#6A9955;">/** The Storage (default \`sessionStorage\`) that will hold cached responses. */</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#9CDCFE;">storage</span><span style="color:#D4D4D4;">?: </span><span style="color:#4EC9B0;">Storage</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#D4D4D4;">};</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="other-methods" tabindex="-1"><a class="header-anchor" href="#other-methods" aria-hidden="true">#</a> Other Methods</h3><p>API Callers have a few other methods available as well:</p>`,3),ge=s("p",null,[e("Manually cancel the current request. The promise of the cancelled invocation will be resolved with "),s("code",null,"undefined"),e(" (it is NOT rejected). If using concurrency mode "),s("code",null,'"allow"'),e(", only the most recent invocation is cancelled.")],-1),be=s("p",null,[e("Add a callback to the caller to be invoked when a success response is received from the server. If a promise is returned, this promise will be awaited and will delay the setting of the "),s("code",null,"isLoading"),e(" prop to "),s("code",null,"false"),e(" until it completes.")],-1),_e=s("p",null,[e("Add a callback to the caller to be invoked when a failure response is received from the server. If a promise is returned, this promise will be awaited and will delay the setting of the "),s("code",null,"isLoading"),e(" prop to "),s("code",null,"false"),e(" until it completes.")],-1),we=s("p",null,[e("The invoke function is a reference from the caller to itself. In other words, "),s("code",null,"caller.invoke === caller"),e(". This mirrors the syntax of the Knockout generated method classes.")],-1),Ae=s("p",null,[e("If called a parameter, that parameter will be used as the args object. Otherwise, "),s("code",null,"caller.args"),e(" will be used.")],-1),Ee=s("p",null,"Only exists if the caller was created with the option of being invoked with an args object as described in the sections above.",-1),ke={href:"https://developer.mozilla.org/en-US/docs/Web/API/URL/createObjectURL",target:"_blank",rel:"noopener noreferrer"},qe=s("code",null,"result",-1),Fe=s("code",null,"Vue",-1),Ie=s("p",null,"Only exists if the caller was created with the option of being invoked with an args object as described in the sections above.",-1);function xe(Te,Pe){const l=c("RouterLink"),r=c("ExternalLinkIcon"),t=c("router-link"),o=c("Prop");return u(),h("div",null,[y,p(" MARKER:summary "),s("p",null,[e("The API client layer, generated as "),m,e(", exports a class for each API controller that was generated for your data model. These classes are stateless and provide one method for each API endpoint. This includes both the standard set of endpoints created for "),n(l,{to:"/modeling/model-types/entities.html"},{default:a(()=>[e("Entity Models")]),_:1}),e(" and "),n(l,{to:"/modeling/model-types/dtos.html"},{default:a(()=>[e("Custom DTOs")]),_:1}),e(", as well as any custom "),n(l,{to:"/modeling/model-components/methods.html"},{default:a(()=>[e("Methods")]),_:1}),e(" on the aforementioned types, as well as any methods on your "),n(l,{to:"/modeling/model-types/services.html"},{default:a(()=>[e("Services")]),_:1}),e(".")]),p(" MARKER:summary-end "),s("p",null,[e("The API clients provided by Coalesce are based on "),s("a",f,[e("axios"),n(r)]),e(". All API clients used a shared axios instance, exported from "),v,e(" as "),C,e(". This instance can be used to configure all HTTP requests made by Coalesce, including things like attaching "),s("a",g,[e("interceptors"),n(r)]),e(" to modify the requests being made, or configuring "),s("a",b,[e("defaults"),n(r)]),e(".")]),s("p",null,[e("As with all the layers, the "),s("a",_,[e("source code of coalesce-vue"),n(r)]),e(" is also a great supplement to this documentation.")]),s("nav",w,[s("ul",null,[s("li",null,[n(t,{to:"#concepts"},{default:a(()=>[e("Concepts")]),_:1}),s("ul",null,[s("li",null,[n(t,{to:"#api-client"},{default:a(()=>[e("API Client")]),_:1})]),s("li",null,[n(t,{to:"#api-callers-api-states"},{default:a(()=>[e("API Callers/API States")]),_:1})])])]),s("li",null,[n(t,{to:"#api-callers"},{default:a(()=>[e("API Callers")]),_:1}),s("ul",null,[s("li",null,[n(t,{to:"#creating-and-invoking-an-api-caller"},{default:a(()=>[e("Creating and Invoking an API Caller")]),_:1})]),s("li",null,[n(t,{to:"#properties"},{default:a(()=>[e("Properties")]),_:1})]),s("li",null,[n(t,{to:"#concurrency-mode"},{default:a(()=>[e("Concurrency Mode")]),_:1})]),s("li",null,[n(t,{to:"#response-caching"},{default:a(()=>[e("Response Caching")]),_:1})]),s("li",null,[n(t,{to:"#other-methods"},{default:a(()=>[e("Other Methods")]),_:1})])])])])]),A,s("p",null,[e("For the methods that correspond to the standard set of CRUD endpoints that Coalesce provides ("),E,e(", "),k,e(", "),q,e(", "),F,e(", "),I,e("), an additional parameter "),x,e(" is available that accepts the set of "),n(l,{to:"/modeling/model-components/data-sources.html#standard-parameters"},{default:a(()=>[e("Standard Parameters")]),_:1}),e(" appropriate for the endpoint.")]),s("p",null,[e("Each method returns a "),T,e(" where "),P,e(" is either "),R,e(", "),S,e(", or "),L,e(", depending on the return type of the API endpoint. "),j,e(" is the "),s("a",B,[e("response object from axios"),n(r)]),e(", containing the "),W,e(" in its "),M,e(" property, as well as other properties like "),O,e(". The returned type "),N,e(" is automatically converted into valid "),n(l,{to:"/stacks/vue/layers/models.html"},{default:a(()=>[e("Model implementations")]),_:1}),e(" for you.")]),U,V,s("p",null,[e("Because they are such an integral part of the overall picture of "),H,e(", they have "),n(l,{to:"/stacks/vue/layers/api-clients.html"},{default:a(()=>[e("their own section below")]),_:1}),e(" where they are explained in much greater detail.")]),$,s("p",null,[e("API Callers can be created so that they have an "),z,e(" object that can be bound to, using "),K,e(" to make a request using those arguments as the API endpoint's parameters. The API Callers created for the "),n(l,{to:"/stacks/vue/layers/viewmodels.html"},{default:a(()=>[e("ViewModel Layer")]),_:1}),e(" are all created this way.")]),G,J,s("div",Q,[X,s("p",null,[e("During typical development, it is unlikely that you'll need to make a custom API Caller - the ones created for you on the generated "),n(l,{to:"/stacks/vue/layers/viewmodels.html"},{default:a(()=>[e("ViewModel Layer")]),_:1}),e(" will usually suffice. However, creating your own can allow for some more advanced functionality.")])]),Y,s("p",null,[e("A caller that has an args object that can be bound to. This is how the generated API Callers in the "),n(l,{to:"/stacks/vue/layers/viewmodels.html"},{default:a(()=>[e("ViewModel Layer")]),_:1}),e(" are created:")]),Z,n(o,{def:"isLoading: boolean",lang:"ts"}),ee,n(o,{def:"wasSuccessful: boolean | null",lang:"ts"}),se,n(o,{def:"message: string | null",lang:"ts"}),ne,n(o,{def:"hasResult: boolean",lang:"ts"}),ae,n(o,{def:"args: {}",lang:"ts"}),oe,le,n(o,{def:"get url(): string",lang:"ts"}),te,re,ie,n(o,{def:"result: T | null",lang:"ts",id:"member-result-item"}),ce,n(o,{def:"validationIssues: ValidationIssue[] | null",lang:"ts"}),s("p",null,[e("Any validation issues returned by the previous request. This is never populated automatically by Coalesce, and is therefore is only used if you have written custom code to populate it in your "),n(l,{to:"/modeling/model-components/behaviors.html"},{default:a(()=>[e("Behaviors")]),_:1}),e(" or "),n(l,{to:"/modeling/model-components/methods.html"},{default:a(()=>[e("Methods")]),_:1}),e(".")]),pe,n(o,{def:"result: Array<T> | null",lang:"ts",id:"member-result-list"}),de,n(o,{def:"page, pageSize, pageCount, totalCount: number | null",lang:"ts",id:"members-pagination"}),ue,he,n(o,{def:"setConcurrency(mode: 'disallow' | 'debounce' | 'cancel' | 'allow')",lang:"ts"}),De,s("p",null,[e("This completely aborts the request, propagating all the way back to the server where cancellation can be observed with "),s("a",ye,[e("HttpContext.RequestAborted"),n(r)]),e(". The promise of the cancelled invocation will be resolved with "),me,e(" (it is NOT rejected).")]),fe,n(o,{def:"useResponseCaching(configuration?: ResponseCachingConfiguration | false)",lang:"ts"}),s("p",null,[e("Enables response caching on the API Caller. Only "),n(l,{to:"/modeling/model-components/attributes/controller-action.html"},{default:a(()=>[e("HTTP GET methods")]),_:1}),e(" are supported, and "),n(l,{to:"/modeling/model-components/methods.html#file-downloads"},{default:a(()=>[e("file-returning methods")]),_:1}),e(" are not supported. Call with "),ve,e(" to disable caching after it was previously enabled. The available options are as follows:")]),Ce,n(o,{def:"cancel(): void",lang:"ts"}),ge,n(o,{def:"onFulfilled((state: TInvoker) => void | Promise<any>): void",lang:"ts"}),be,n(o,{def:"onRejected((state: TInvoker) => void | Promise<any>): void",lang:"ts"}),_e,n(o,{def:"invoke(...args: TArgs)",lang:"ts"}),we,n(o,{def:"invokeWithArgs(args?: {})",lang:"ts"}),Ae,Ee,n(o,{def:"getResultObjectUrl(vue: Vue): string | undefined",lang:"ts"}),s("p",null,[e("If the method returns a file, this method will return an "),s("a",ke,[e("Object URL"),n(r)]),e(" representing the value of the "),qe,e(" prop. Requires a "),Fe,e(" instance to be provided in order to manage the lifecycle of the URL, since object URLs must be manually released to avoid memory leaks. When the provided Vue component is destroyed, the object URL will be destroyed.")]),Ie])}const Se=d(D,[["render",xe],["__file","api-clients.html.vue"]]);export{Se as default};
